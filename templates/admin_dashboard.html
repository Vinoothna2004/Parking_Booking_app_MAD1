{% extends "admin_layout.html" %} <!-- Inherited all nav features -->
{% block content %}
<div class="container">
  {% if parkinglots %}
    <div class="text-center mb-3">
      <h2>Parking Lots</h2>
    </div>
    <div class="row">
      {% for lot in parkinglots %}
        <div class="col-md-4">
          <div class="border rounded p-3 mb-3">
            <h5>{{ lot.prime_location_name }}</h5>
            <!-- <a href="/edit_lot/{{ lot.id }}">Edit</a>  -->
            <a href="{{ url_for('edit_parking_lot', lot_id=lot.id) }}" class="btn btn-warning btn-sm">Edit</a>|
            <!-- <a href="/delete_lot/{{ lot.id }}" onclick="return confirm('Are you sure?')">Delete</a> -->
            <form method="POST" action="{{ url_for('delete_parking_lot', lot_id=lot.id) }}" style="display:inline;">
      <button type="submit" class="btn btn-danger btn-sm" onclick="return confirm('Are you sure you want to delete this parking lot?');">
        Delete
      </button>
    </form>
          <p class="text-success">
          (Occupied: {{ lot.slots | selectattr('status.value', 'equalto',
          'Occupied') | list | length }}/{{ lot.capacity }})
        </p>

            <div class="d-flex flex-wrap">
  {% for slot in lot.slots %}
    {% if slot.status.value == 'Occupied' %}
      <a href="{{ url_for('view_delete_slot', slot_id=slot.id) }}" style="text-decoration: none;">
        <div 
          class="m-1 px-2 py-1 bg-danger text-white rounded"
          style="cursor: pointer;"
        >
          O
        </div>
      </a>
    {% else %}
      <a href="{{ url_for('view_delete_slot', slot_id=slot.id) }}" style="text-decoration: none;">
        <div 
          class="m-1 px-2 py-1 bg-success text-white rounded"
          style="cursor: pointer;"
        >
          A
        </div>
      </a>
    {% endif %}
  {% endfor %}
</div>




          </div>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <h3 class="center">No Parking Lots are available!!</h3>
  {% endif %}

  <!-- Add Lot Button -->
  <div class="text-center mt-4">
    <a href="/add_lot" class="btn btn-outline-warning">+ Add Lot</a>
  </div>
</div>
{% endblock %}
